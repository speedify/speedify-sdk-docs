<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Speedify SDK for Android: Service Notification</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<link href="css/rawline.css" rel="stylesheet">
<link rel="shortcut icon" href="logo.png" />
<link href="overrides.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Speedify SDK for Android
   &#160;<span id="projectnumber">14.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Service Notification </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The main processing and VPN service of the Speedify SDK is done in an Android foreground service running in a background process. Starting with Android Oreo, foreground services are required to have a notification visible at all times. Prior to Oreo it is still recommened to have this notification so that the OS knows that the service is important, and that it should not be killed in low memory situations.</p>
<p>As of Android 13, <code>POST_NOTIFICATIONS</code> permission is required to show the foreground service notification. </p><div class="fragment"><div class="line"><span class="comment">// notification permission is required for foreground service notification to show</span></div><div class="line"><span class="keywordflow">if</span> (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.TIRAMISU) {</div><div class="line">  NotificationManager mNotifyMgr = (NotificationManager) getApplicationContext().getSystemService(Context.NOTIFICATION_SERVICE);</div><div class="line">  <span class="keywordflow">if</span> (!mNotifyMgr.areNotificationsEnabled()) {</div><div class="line">    ActivityCompat.requestPermissions(<span class="keyword">this</span>, <span class="keyword">new</span> String[] { android.Manifest.permission.POST_NOTIFICATIONS }, 100);</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>The default <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html">SpeedifyHandler</a> provided by the Speedify SDK implements a notification for the foreground service, complete with connect, disconnect, and exit controls.</p>
<p>The text of this notification is customizable via the default service notification resource strings outlined in <a class="el" href="userstrings.html">SDK Strings</a>.</p>
<p>The default icon used is drawable resource named <code>speedify_notification_icon</code>. This can be overridden via <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#aba0c53bca630a3d3654a84b7dd45d745">setServiceNotificationIcon</a>.</p>
<p>The default click action is to launch the main launcher intent of the application, as returned by <a href="https://developer.android.com/reference/android/content/pm/PackageManager#getLaunchIntentForPackage(java.lang.String)">PackageManager.getLaunchIntentForPackage</a>. This can be overridden via <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#ae86eb9258e54507dc5d06cdbfa91a425">setServiceNotificationLaunchIntent</a>.</p>
<p>If you want to completely customize the notification, you can override <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#a23374b2c7d8897eb37cb384079f941a8">UpdateForegroundNotification</a> and <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#a4577b9f6fc750d00bec0e85d14985c28">HideForegroundNotification</a> in <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html">SpeedifyHandler</a>, and provide your own notification. You must also use a notification ID of <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#ac3b7796fd1987a2ded35980a54cbc99e">SpeedifyHandler.SPEEDIFY_FOREGROUND_NOTIFICATION_ID</a> to replace the temporary minimal foreground notification that is generated to avoid ANRs. The notification channel used is <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#ab8f0d85a09ee4065be9691436db077d9">SpeedifyHandler.SPEEDIFY_FOREGROUND_CHANNEL_ID</a>.</p>
<p><b>NOTE</b> : <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#a23374b2c7d8897eb37cb384079f941a8">UpdateForegroundNotification</a> and <a class="el" href="classcom_1_1speedify_1_1speedifysdk_1_1_speedify_handler.html#a4577b9f6fc750d00bec0e85d14985c28">HideForegroundNotification</a> are called from the background process. You will not be able to access objects running in your UI process.</p>
<div class="fragment"><div class="line">mySpeedifySDKObject.setHandler(<span class="keyword">new</span> SpeedifyHandler() {</div><div class="line"></div><div class="line">  @Override</div><div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> UpdateForegroundNotification(Service service, Types.State state, String serverName, <span class="keywordtype">boolean</span> killswitchActive)  {        </div><div class="line">    NotificationCompat.Builder builder = <span class="keyword">new</span> NotificationCompat.Builder(service, MY_NOTIFICATION_CHANNEL_ID);</div><div class="line">    builder.setContentTitle(<span class="stringliteral">&quot;MyVPN&quot;</span>).setContentText(state.toString()).setSmallIcon(R.drawable.notification_icon);</div><div class="line">    Notification n = builder.build();</div><div class="line">    service.startForeground(MY_FOREGROUND_NOTIFICATION_ID, n);</div><div class="line">  }</div><div class="line"></div><div class="line">  @Override</div><div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> HideForegroundNotification(Service service) {</div><div class="line">    NotificationManager nMgr = (NotificationManager) service.getApplicationContext().getSystemService(Context.NOTIFICATION_SERVICE);</div><div class="line">    nMgr.cancel(MY_FOREGROUND_NOTIFICATION_ID);</div><div class="line">  }</div><div class="line"></div><div class="line">});</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
